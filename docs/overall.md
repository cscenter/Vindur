#Документация Vindur
##Введение
Vindur - это встраиваемая NoSQL база данных.

Особенности:

- Позволяет выполнять быстрый поиск по нескольким критериям
- Все операции в оперативной памяти
- Легко установить и настроить
- Полностью написана на Java

##Зачем это нужно?
Представьте себе обыкновенный магазин с миллионом товаров. Каждый товар обладает множеством различных характеристик.
Зачастую поиск подходящих товаров производится по нескольким характеристикам, а сами товары могут находиться в разных
категориях. Все это требует от поискового движка возможность осуществлять быстрый многокритериальный поиск.

##Архитектура
Vindur базируется на колоночной архитектуре - данные в ней представляют собой совокупность колонок. Это значительно
ускоряет выборку по нескольким атрибутам, в отличие от БД с построчной архитектурой. Данные в Vindur представлены как
набор документов с уникальным идентификатором. Документ представляет собой совокупность значений атрибутов.

Vindur имеет несколько типов хранилищ, оптимизированных для различных поисковых запросов:

- **StorageExact** - запросы на точное совпадение
- **StorageRange** - запросы в диапазоне для строк и вещественных чисел
- **StorageBucketIntegers** - запросы в диапазоне для целых чисел
- **StorageLucene** - Lucene-запросы

**TODO** *Написать про StorageHierarchy и придумать соответствующие примеры*

Результатом выполнения поискового запроса к хранилищу является BitSet, с помощью которого формируется список
идентификаторов подходящих документов. Для всех хранилищ в Vindur используется EWAHBitSet.  
Запросы обрабатываются и оптимизируются в процессе выполнения *исполнителем запросов*.  
В Vindur есть три исполнителя:

- **DumbExecutor** - последовательно выполняет AND для каждого битсета;  
- **TinyExecutor** - получает битсеты в порядке возрастания количества документов в хранилище. Если после очередной
операции AND получен пустой битсет, исполнитель возвращает пустой результат;  
- **SmartExecutor** - как и TinyExecutor сортирует хранилища, но в некоторый момент времени может начать перебор
значений хранилища вместо получения битсета.

Стандартным исполнителем является DumbExecutor.

##Обзор
###Установка
Репозиторий проекта на [GitHub]
###Маленькая задача
Поиск книг в интернет-магазине. При этом каждая книга может обладать атрибутами, которых нет у другой книги.
Также, каждый атрибут может иметь несколько значений, например зачастую авторов бывает несколько. 

###Настройка
Чтобы создать и настроить движок нужно подготовить все хранилища и выбрать исполнитель запросов

    Engine engine = Engine.build()
        .executor(new TinyExecutor())
        .storage("Price", new StorageBucketIntegers())
        .storage("ISBN", new StorageExact())
        .storage("Title", new StorageExact())
        .storage("Author", new StorageExact())
        .storage("Artist", new StorageExact())
        .storage("Annotation", new StorageLucene())
        .init();

###Заполнение
Перед тем как добавить объект в базу данных, нужно создать новый документ:  

    int docId = engine.createDocument();
    
Теперь, обращаясь к документу по id, можно установить его атрибуты, например:

    engine.setValue(docId, "Price", "399");
    engine.setValue(docId, "Author", "Носов Н.");
    engine.setValue(docId, "Title", "Незнайка на луне");
    engine.setValue(docId, "ISBN", "5-699-13348-8");

###Запросы
Каждое хранилище выполняет только один тип запросов. Это значит, что на этапе построения запроса важно каждому
хранилищу передать тот запрос, который оно умеет обрабатывать, например:

    Query query = Query.build()
        .query("Price", new RangeRequest(50, 400))
        .query("Author", "Марк Твен")
        .query("Annotation",
            new QueryParser("text", new WhitespaceAnalyzer()).parse("детская книга")));
    List<Integer> foundBooks = engine.executeQuery(query);
    
##О проекте
Студенческий проект в Computer Science Center, 2014 год. Участники:  
Эдгар Жаворонков <edzhavoronkov@gmail.com>  
Сергей Кривохатский <s.krivokhatskiy@gmail.com>  
Андрей Кокорев <a.d.kokorev@gmail.com>  
Павел Чурсин <pch.busy@gmail.com>  

Куратор проекта Филипп Дельгядо <phillip.delgyado@jetbrains.com>

#Примечания к коду
Пока здесь пусто...

[GitHub]:https://github.com/cscenter/Vindur/